imports:
  root: __package__.yml
docs: >-
  Create, update, delete, and manage
  [segments](https://docs.getunleash.io/reference/segments).
service:
  auth: false
  base-path: ''
  display-name: Segments
  endpoints:
    createSegment:
      display-name: Create a new segment
      docs: Creates a new segment using the payload provided
      errors:
        - root.BadRequestError
        - root.UnauthorizedError
        - root.ForbiddenError
        - root.ConflictError
        - root.UnsupportedMediaTypeError
      examples:
        - request:
            constraints:
              - contextName: appName
                operator: NOT_IN
            name: beta-users
          response:
            body:
              constraints:
                - caseInsensitive: true
                  contextName: appName
                  inverted: true
                  operator: NOT_IN
                  value: my-app
                  values:
                    - my-app
                    - my-other-app
              createdAt: '2023-04-12T11:13:31Z'
              createdBy: someone@example.com
              description: IOS users segment
              id: 2
              name: ios-users
              project: red-vista
              usedInFeatures: 3
              usedInProjects: 2
      method: POST
      path: /api/admin/segments
      request:
        body: root.UpsertSegmentSchema
        content-type: application/json
      response:
        docs: The resource was successfully created.
        status-code: 201
        type: root.AdminSegmentSchema
      source:
        openapi: openapi.json
    getSegment:
      display-name: Get a segment
      docs: Retrieves a segment based on its ID.
      errors:
        - root.NotFoundError
      examples:
        - path-parameters:
            id: 1
          response:
            body:
              constraints:
                - caseInsensitive: true
                  contextName: appName
                  inverted: true
                  operator: NOT_IN
                  value: my-app
                  values:
                    - my-app
                    - my-other-app
              createdAt: '2023-04-12T11:13:31Z'
              createdBy: someone@example.com
              description: IOS users segment
              id: 2
              name: ios-users
              project: red-vista
              usedInFeatures: 3
              usedInProjects: 2
      method: GET
      path: /api/admin/segments/{id}
      path-parameters:
        id:
          docs: a segment id
          type: integer
      response:
        docs: adminSegmentSchema
        status-code: 200
        type: root.AdminSegmentSchema
      source:
        openapi: openapi.json
    getSegments:
      display-name: Get all segments
      docs: Retrieves all segments that exist in this Unleash instance.
      examples:
        - response:
            body:
              segments:
                - constraints:
                    - contextName: appName
                      operator: NOT_IN
                      value: my-app
                  createdAt: '2023-04-12T11:13:31Z'
                  createdBy: someone@example.com
                  description: IOS users segment
                  id: 2
                  name: ios-users
                  project: red-vista
                  usedInFeatures: 3
                  usedInProjects: 2
      method: GET
      path: /api/admin/segments
      response:
        docs: segmentsSchema
        status-code: 200
        type: root.SegmentsSchema
      source:
        openapi: openapi.json
    getSegmentsByStrategyId:
      display-name: Get strategy segments
      docs: >-
        Retrieve all segments that are referenced by the specified strategy.
        Returns an empty list of segments if the strategy ID doesn't exist.
      examples:
        - path-parameters:
            strategyId: strategyId
          response:
            body:
              segments:
                - constraints:
                    - contextName: appName
                      operator: NOT_IN
                      value: my-app
                  createdAt: '2023-04-12T11:13:31Z'
                  createdBy: someone@example.com
                  description: IOS users segment
                  id: 2
                  name: ios-users
                  project: red-vista
                  usedInFeatures: 3
                  usedInProjects: 2
      method: GET
      path: /api/admin/segments/strategies/{strategyId}
      path-parameters:
        strategyId: string
      response:
        docs: segmentsSchema
        status-code: 200
        type: root.SegmentsSchema
      source:
        openapi: openapi.json
    getStrategiesBySegmentId:
      display-name: Get strategies that reference segment
      docs: Retrieve all strategies that reference the specified segment.
      examples:
        - path-parameters:
            id: 1
          response:
            body:
              changeRequestStrategies:
                - environment: development
                  featureName: new-signup-flow
                  id: e465c813-cffb-4232-b184-82b1d6fe9d3d
                  projectId: red-vista
                  strategyName: flexibleRollout
              strategies:
                - environment: development
                  featureName: new-signup-flow
                  id: e465c813-cffb-4232-b184-82b1d6fe9d3d
                  projectId: red-vista
                  strategyName: flexibleRollout
      method: GET
      path: /api/admin/segments/{id}/strategies
      path-parameters:
        id:
          docs: a segment id
          type: integer
      response:
        docs: segmentStrategiesSchema
        status-code: 200
        type: root.SegmentStrategiesSchema
      source:
        openapi: openapi.json
    removeSegment:
      display-name: Deletes a segment by id
      docs: Deletes a segment by its id, if not found returns a 409 error
      errors:
        - root.UnauthorizedError
        - root.ForbiddenError
        - root.ConflictError
      examples:
        - path-parameters:
            id: 1
      method: DELETE
      path: /api/admin/segments/{id}
      path-parameters:
        id:
          docs: a segment id
          type: integer
      source:
        openapi: openapi.json
    updateSegment:
      display-name: Update segment by id
      docs: >-
        Updates the content of the segment with the provided payload. Requires
        `name` and `constraints` to be present. If `project` is not present, it
        will be set to `null`. Any other fields not specified will be left
        untouched.
      errors:
        - root.BadRequestError
        - root.UnauthorizedError
        - root.ForbiddenError
        - root.ConflictError
        - root.UnsupportedMediaTypeError
      examples:
        - path-parameters:
            id: 1
          request:
            constraints:
              - contextName: appName
                operator: NOT_IN
            name: beta-users
      method: PUT
      path: /api/admin/segments/{id}
      path-parameters:
        id:
          docs: a segment id
          type: integer
      request:
        body: root.UpsertSegmentSchema
        content-type: application/json
      source:
        openapi: openapi.json
    validateSegment:
      display-name: Validates if a segment name exists
      docs: >-
        Uses the name provided in the body of the request to validate if the
        given name exists or not
      errors:
        - root.BadRequestError
        - root.UnauthorizedError
        - root.ConflictError
        - root.UnsupportedMediaTypeError
      examples:
        - request:
            name: betaUser
      method: POST
      path: /api/admin/segments/validate
      request:
        body: root.NameSchema
        content-type: application/json
      source:
        openapi: openapi.json
  source:
    openapi: openapi.json
